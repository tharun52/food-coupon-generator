<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Customize Number Style</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    #canvasContainer {
      width: 500px;
      height: 500px;
      overflow: hidden;
      border: 1px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    canvas {
      max-width: 100%;
      max-height: 100%;
    }

    .controls {
      margin-top: 20px;
    }
    select#fontFamily option {
      font-size: 16px;
      padding: 4px;
    }

  </style>
</head>
<body>
  <h1>Customize Number Style</h1>
  
  <div id="canvasContainer">
    <canvas id="previewCanvas"></canvas>
  </div>

  <div class="controls">
    <label>
      Font Size:
      <input type="number" id="fontSize" value="40" step="2" />
    </label>

    <label>
      Font Family:
      <select id="fontFamily">
        <option value="Arial" style="font-family: Arial;">Arial (001)</option>
        <option value="Georgia" style="font-family: Georgia;">Georgia (001)</option>
        <option value="Courier New" style="font-family: 'Courier New';">Courier New (001)</option>
        <option value="Verdana" style="font-family: Verdana;">Verdana (001)</option>
        <option value="Times New Roman" style="font-family: 'Times New Roman';">Times New Roman (001)</option>
        <option value="Comic Sans MS" style="font-family: 'Comic Sans MS';">Comic Sans MS (001)</option>
        <option value="Impact" style="font-family: Impact;">Impact (001)</option>
        <option value="Tahoma" style="font-family: Tahoma;">Tahoma (001)</option>
        <option value="Trebuchet MS" style="font-family: 'Trebuchet MS';">Trebuchet MS (001)</option>
        <option value="Lucida Console" style="font-family: 'Lucida Console';">Lucida Console (001)</option>
        
        <!-- 10 More Fonts -->
        <option value="Franklin Gothic Medium" style="font-family: 'Franklin Gothic Medium';">Franklin Gothic Medium (001)</option>
        <option value="Gill Sans" style="font-family: 'Gill Sans';">Gill Sans (001)</option>
        <option value="Calibri" style="font-family: Calibri;">Calibri (001)</option>
        <option value="Cambria" style="font-family: Cambria;">Cambria (001)</option>
        <option value="Garamond" style="font-family: Garamond;">Garamond (001)</option>
        <option value="Rockwell" style="font-family: Rockwell;">Rockwell (001)</option>
        <option value="Segoe UI" style="font-family: 'Segoe UI';">Segoe UI (001)</option>
        <option value="Palatino Linotype" style="font-family: 'Palatino Linotype';">Palatino Linotype (001)</option>
        <option value="Perpetua" style="font-family: Perpetua;">Perpetua (001)</option>
        <option value="Century Gothic" style="font-family: 'Century Gothic';">Century Gothic (001)</option>
      </select>
    </label>
    
    

    <label>
      Font Color:
      <input type="color" id="fontColor" value="#000000" />
    </label>

    <label>Position:</label>
    <select id="positionSelect">
      <option value="">-- Choose Position --</option>
      <option value="top-left">Top Left</option>
      <option value="top-right">Top Right</option>
      <option value="bottom-left">Bottom Left</option>
      <option value="bottom-right">Bottom Right</option>
      <option value="center">Center</option>
    </select>

    <button class="btn" id="generateBtn">Generate</button>
  </div>

  <script>
    const canvas = document.getElementById("previewCanvas");
    const ctx = canvas.getContext("2d");
    const img = new Image();
    const text = "001"; // three-digit number

    let fontSize = 40;
    let fontFamily = "Arial";
    let fontColor = "#000000";
    let selectedPosition = "";

    const uploadedImageData = localStorage.getItem("uploadedImage");
    if (!uploadedImageData) {
      alert("No uploaded image found. Redirecting...");
      window.location.href = "index.html";
    }

    img.src = uploadedImageData;

    img.onload = () => {
      canvas.width = img.width;
      canvas.height = img.height;
      applyPosition(selectedPosition);
    };

    function drawCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);

      ctx.font = `${fontSize}px ${fontFamily}`;
      ctx.fillStyle = fontColor;
      ctx.fillText(text, textX, textY);
    }

    function textWidth() {
      ctx.font = `${fontSize}px ${fontFamily}`;
      return ctx.measureText(text).width;
    }

    function textHeight() {
      return fontSize;
    }

    let textX = 50;
    let textY = 50;

    function applyPosition(pos) {
      const width = textWidth();
      const height = textHeight();

      switch (pos) {
        case "top-left":
          textX = 20;
          textY = 20 + height;
          break;
        case "top-right":
          textX = canvas.width - width - 20;
          textY = 20 + height;
          break;
        case "bottom-left":
          textX = 20;
          textY = canvas.height - 20;
          break;
        case "bottom-right":
          textX = canvas.width - width - 20;
          textY = canvas.height - 20;
          break;
        case "center":
          textX = canvas.width / 2 - width / 2;
          textY = canvas.height / 2 + height / 2;
          break;
        default:
          textX = canvas.width - width - 20;
          textY = 20 + height;
      }

      drawCanvas();
    }

    function updateFontSettings() {
      fontSize = parseInt(document.getElementById("fontSize").value);
      fontFamily = document.getElementById("fontFamily").value;
      fontColor = document.getElementById("fontColor").value;
      applyPosition(selectedPosition); // Reapply position after style change
    }

    document.getElementById("positionSelect").addEventListener("change", (e) => {
      selectedPosition = e.target.value;
      applyPosition(selectedPosition);
    });

    document.getElementById("fontSize").addEventListener("input", updateFontSettings);
    document.getElementById("fontFamily").addEventListener("change", updateFontSettings);
    document.getElementById("fontColor").addEventListener("input", updateFontSettings);

    document.getElementById("generateBtn").onclick = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);

      const cleanImage = canvas.toDataURL();
      localStorage.setItem("editedImage", cleanImage);
      localStorage.setItem("numberPosition", JSON.stringify({ x: textX, y: textY }));
      localStorage.setItem("fontSize", fontSize);
      localStorage.setItem("fontFamily", fontFamily);
      localStorage.setItem("fontColor", fontColor);

      drawCanvas(); // Show preview again

      window.location.href = "generate.html";
    };
  </script>
</body>
</html>
